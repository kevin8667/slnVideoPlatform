<div class="card flex gap-3">
  <!-- 搜尋和換頁功能放在同一個區塊 -->
  <div class="flex pageBar">
    <!-- 換頁功能 -->
    <div class="flex align-items-center gap-3">
      <span class="text-label">每頁文章筆數:{{ forumDto.pageSize }}</span>
      <p-slider
        [(ngModel)]="forumDto.pageSize"
        (ngModelChange)="onSliderChange()"
        [style]="{ width: '10rem' }"
        [min]="10"
        [max]="100"
        [step]="10"
      ></p-slider>
    </div>
    <div>
      <p-paginator
        (onPageChange)="changePage($event)"
        [first]="pages.first"
        [rows]="forumDto.pageSize"
        [totalRecords]="pages.totalRecords"
        [showFirstLastIcon]="true"
        [showCurrentPageReport]="true"
        currentPageReportTemplate="第{first}筆 - 第{last}筆 總共 {totalRecords}筆"
      ></p-paginator>
    </div>
    <!-- 搜尋功能 -->
    <div class="flex align-items-center">
      <span class="p-input-icon-left">
        <i class="pi pi-search"></i>
        <input
          type="text"
          pInputText
          pTooltip="作者、標題、內容"
          [(ngModel)]="forumDto.keyword"
          (keydown.enter)="search()"
          placeholder="搜尋此討論區"
        />
      </span>
      <div class="fixed-button">
        <p-button
          label="發表文章"
          icon="pi pi-plus"
          severity="primary"
          (onClick)="openCreateArticleDialog()"
        ></p-button>
      </div>
    </div>
  </div>
</div>

<!-- 文章列表開始 -->
<div class="flex mt-3">
  <!-- 左側廣告區-->
  <div class="d1">
    <div id="ad-container">
      <!-- 廣告 -->
      <a href="Https://www.google.com.tw">
        <p-galleria
          [value]="images"
          [autoPlay]="true"
          [circular]="true"
          [showThumbnails]="false"
          [transitionInterval]="10000"
        >
          >
          <ng-template pTemplate="item" let-item>
            <img [src]="item.pic" />
          </ng-template>
        </p-galleria>
      </a>
      <!-- <img src="/assets/images/forumAd.png" alt="飄香的咖啡" /> -->
    </div>
  </div>
  <!-- 中間上方篩選主題 -->
  <div class="d2">
    <div class="button-container">
      <p-button
        (onClick)="loadTheme(0)"
        label="全部主題"
        severity="primary"
        class="ui-button"
      ></p-button>

      <p-button
        (onClick)="loadTheme(0)"
        label="我的收藏"
        severity="success"
        class="ui-button"
      ></p-button>

      <p-button
        *ngFor="let item of themeTag"
        (onClick)="loadTheme(item.themeId)"
        label="{{ item.themeName }}"
        severity=""
        class="ui-button"
      ></p-button>
    </div>
    <div class="mt-3">
      <p-dataView
        [value]="articles"
        layout="grid"
        [paginator]="false"
        [rows]="forumDto.pageSize"
        [totalRecords]="pages.totalRecords"
      >
        <!-- Grid Item 模板 -->
        <ng-template pTemplate="gridItem" let-article>
          <div class="p-card p-component grid-item">
            <div class="card-content">
              <div class="card-image">
                <a routerLink="{{ article.articleId }}"
                  ><img
                    [src]="article.coverImageUrl || 'assets/images/avantar.jpg'"
                    alt="Article Cover"
                    class="article-cover"
                /></a>
              </div>
              <div class="card-body">
                <div class="p-card-title">{{ article.title }}</div>
                <div class="p-card-subtitle">
                  {{ article.themeName }} - {{ article.nickName }}
                </div>
                <div class="p-card-body-content">
                  <p>{{truncateText(article.articleContent, 45)}}</p>
                  <p>
                    <i class="pi pi-calendar"></i> 更新時間:
                    {{ article.updateDate | forumDate }}
                  </p>
                  <p>
                    <i class="pi pi-comments"></i> 回覆數:
                    {{ article.replyCount }}
                  </p>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
      </p-dataView>
    </div>
  </div>
  <!-- 右側聊天室 -->
  <div class="d3">
    <!-- 聊天室區域 -->
    <div class="chat-section">
      <div class="chat-header">
        <h1>聊天室</h1>
      </div>
      <div class="chat-messages">
        <div class="message">
          <div class="message-user">用戶1:</div>
          <div class="message-text">你好！</div>
        </div>
        <div class="message">
          <div class="message-user">用戶2:</div>
          <div class="message-text">嗨，你好！</div>
        </div>
        <!-- 更多消息可以添加在這裡 -->
      </div>
      <div class="chat-input">
        <input type="text" placeholder="輸入消息..." />
        <button>發送</button>
      </div>
    </div>
  </div>
</div>
